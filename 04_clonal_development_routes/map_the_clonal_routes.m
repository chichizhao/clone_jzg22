% matlab2022b
% author: zhaochichi github: https://github.com/chichizhao/clone_jzg22
% function: read the tiff, shape file than display them in the map, map the phylogenetic tree on the map

% read the tiff file 
tiff = imread('path\jzg3_Clip3_1.tif');

% as the file is too large, we need make it smaller

Red = tiff(:,:,1);
Green = tiff(:,:,2);
Blue = tiff(:,:,3);
alpha = tiff(:,:,4);

% plot the tiff file 
tif_rgb = cat(3, Red, Green, Blue);
imshow(tif_rgb);
title('tiff file');

DEM= imread('path\jzg_DEM_Clip1.tif');
DEM = flipud(DEM);
[rows, cols,~] = size(tif_rgb)
DEM = DEM(1:rows, 1:cols);

info = geotiffinfo('path\jzg3_Clip3_1.tif');
[xlim,ylim] = deal(info.BoundingBox(1:2,1),info.BoundingBox(1:2,2));
[X,Y] = meshgrid(linspace(xlim(1),xlim(2),cols),linspace(ylim(1),ylim(2),rows));
S = shaperead('path\T_lat\typha_jzg22.shp');

figure 
h = surf(X,Y,double(DEM),'EdgeColor','none');

% apply the RGB image as a texture map
set(h,'CData',flipud(tif_rgb),'FaceColor','texturemap');

% set the alpha data for transparencey
set(h, 'AlphaData', flipud(alpha), 'FaceAlpha', 'texturemap');


zlim([2620,2680]); % Set Z-axis limits
% remove the mark of z lab
set(gca,'ZTickLabel',[]);
% remove the label line of z
set(gca,'ZTick',[]);
xlim([103.754,103.7671]);
xlim([103.7545,103.7658]);
% remove the mark of x 
set(gca,'XTickLabel',[]);
set(gca,'XTick',[]);
set(gca, 'XTick', [103.755, 103.760, 103.765]);
set(gca, 'XTickLabel', {'103.755° E', '103.760° E', '103.765° E'});
ylim([33.246,33.265]);
ylim([33.2475,33.2645]);
set(gca,'YTickLabel',[]);
set(gca,'YTick',[]);
set(gca, 'YTick', [33.250, 33.255, 33.260]);
set(gca, 'YTickLabel', {'33.250° N', '33.255° N', '33.260° N'});
plot3([103.754,103.762],[33.265,33.265],[2620,2620])
plot3([103.767,103.767],[33.246,33.265],[2620,2620])
plot3([103.7658,103.7658],[33.2645,33.2645],[2000,5000],'k')
plot3([103.7545,103.7545],[33.2645,33.2645],[2000,5000],'k')
plot3([103.7545,03.7658],[33.2645,33.2645],[2500,2500],'k')
G1 = [1,2,3,4,5,6,7,8,9,60,61,10,11]
shapeX = []
shapeY = []
for i = 1:length(S)
    for j = 1:length(G1)

        if S(i).NO == G1(j)
            shapeX(j) = S(i).X
            shapeY(j) = S(i).Y
        end
    end
end
shapeZ = interp2(X, Y, double(DEM), shapeX, shapeY);
%figure
hold on;
plot3(shapeX, shapeY, shapeZ, 'wo', 'MarkerSize', 5, 'MarkerFaceColor', '#dcd116')
G2 = [50,39,38,51,37,52,53,54,55,56,57]
shapeX = []
shapeY = []
for i = 1:length(S)
    for j = 1:length(G2)

        if S(i).NO == G2(j)
            shapeX(j) = S(i).X
            shapeY(j) = S(i).Y
        end
    end
end
shapeZ = interp2(X, Y, double(DEM), shapeX, shapeY);
hold on;
plot3(shapeX, shapeY, shapeZ, 'wo', 'MarkerSize', 5, 'MarkerFaceColor', '#6495ED')

G3 = [36,58,59,35,34,33,32,31,30,29,28,27,25,26,24,23,22,49,48,47,26,45,46,44,43,21,42,20]

shapeX = []
shapeY = []
for i = 1:length(S)
    for j = 1:length(G3)

        if S(i).NO == G3(j)
            shapeX(j) = S(i).X
            shapeY(j) = S(i).Y
        end
    end
end
shapeZ = interp2(X, Y, double(DEM), shapeX, shapeY);

hold on;
plot3(shapeX, shapeY, shapeZ, 'wo', 'MarkerSize', 5, 'MarkerFaceColor', '#32CD32')
G4 = [12,13,19,18,41,64,17,16,40,66,65,63,67,72,71,14,68,70,69,15,62]
shapeX = []
shapeY = []
for i = 1:length(S)
    for j = 1:length(G4)

        if S(i).NO == G4(j)
            shapeX(j) = S(i).X
            shapeY(j) = S(i).Y
        end
    end
end
shapeZ = interp2(X, Y, double(DEM), shapeX, shapeY);

hold on;
plot3(shapeX, shapeY, shapeZ, 'wo', 'MarkerSize', 5, 'MarkerFaceColor', '#b627b1')
area = imread('path\area2.tif')
area = flipud(area)
[y1,x1] = size(area)
z_bottom = zeros(y1, x1)+2000
z_top = DEM
for i = 1:3:x1-3
    for j = 1:5:y1-5
        x_side1 = [X(j,i), X(j,i+3), X(j,i+3), X(j,i)];
        y_side1 = [Y(j,i), Y(j,i+3), Y(j,i+3), Y(j,i)];
        fill3(x_side1, y_side1, [z_bottom(j,i), z_bottom(j,i+3), z_top(j,i+3), z_top(j,i)], [0.85,0.85,0.85], 'EdgeColor', 'none');
        hold on
        x_side2 = [X(j,i), X(j+5,i), X(j+5,i), X(j,i)];
        y_side2 = [Y(j,i), Y(j+5,i), Y(j+5,i), Y(j,i)];
        fill3(x_side2, y_side2, [z_bottom(j,i), z_bottom(j+5,i), z_top(j+5,i), z_top(j,i)], [0.85,0.85,0.85], 'EdgeColor', 'none');
        hold on
    end
end


tree = [[103.759651, 103.7594995, 33.254038, 33.255901, 0, 3000], [103.759348, 103.7594995, 33.257764, 33.255901, 0, 3000], [103.756904, 103.7584095, 33.248951, 33.253951, 0, 3000], [103.759915, 103.7584095, 33.258951, 33.253951, 0, 3000], [103.7594995, 103.7589545, 33.255901, 33.254926, 3000, 3500], [103.7584095, 103.7589545, 33.253951, 33.254926, 3000, 3500], [103.759689, 103.762289, 33.254553, 33.259387000000004, 0, 3500], [103.764889, 103.762289, 33.264221, 33.259387000000004, 0, 3500], [103.7589545, 103.76062175, 33.254926, 33.2571565, 3500, 4000], [103.762289, 103.76062175, 33.259387000000004, 33.2571565, 3500, 4000], [103.76062175, 103.760049375, 33.2571565, 33.255658249999996, 4000, 4500], [103.759477, 103.760049375, 33.25416, 33.255658249999996, 0, 4500], [103.760224, 103.75985349999999, 33.259091, 33.2564565, 0, 2500], [103.759483, 103.75985349999999, 33.253822, 33.2564565, 0, 2500], [103.760714, 103.760153, 33.259293, 33.256757, 0, 2500], [103.759592, 103.760153, 33.254221, 33.256757, 0, 2500], [103.75985349999999, 103.76000325, 33.2564565, 33.25660675, 2500, 3000], [103.760153, 103.76000325, 33.256757, 33.25660675, 2500, 3000], [103.759335, 103.7595755, 33.256076, 33.2555325, 0, 2000], [103.759816, 103.7595755, 33.254989, 33.2555325, 0, 2000], [103.7595755, 103.75825925000001, 33.2555325, 33.25249325, 2000, 2500], [103.756943, 103.75825925000001, 33.249454, 33.25249325, 0, 2500], [103.75825925000001, 103.75874862500001, 33.25249325, 33.252900125, 2500, 3000], [103.759238, 103.75874862500001, 33.253307, 33.252900125, 0, 3000], [103.76000325, 103.75937593750001, 33.25660675, 33.2547534375, 3000, 3500], [103.75874862500001, 103.75937593750001, 33.252900125, 33.2547534375, 3000, 3500], [103.75937593750001, 103.75928746875, 33.2547534375, 33.25580021875, 3500, 4000], [103.759199, 103.75928746875, 33.256847, 33.25580021875, 0, 4000], [103.75928746875, 103.759339734375, 33.25580021875, 33.254907109375, 4000, 4500], [103.759392, 103.759339734375, 33.254014, 33.254907109375, 0, 4500], [103.760049375, 103.7596945546875, 33.255658249999996, 33.2552826796875, 4500, 5000], [103.759339734375, 103.7596945546875, 33.254907109375, 33.2552826796875, 4500, 5000], [103.7596945546875, 103.75921477734374, 33.2552826796875, 33.25389483984375, 5000, 5500], [103.758735, 103.75921477734374, 33.252507, 33.25389483984375, 0, 5500], [103.758984, 103.7592475, 33.25319, 33.254441, 0, 5500], [103.759511, 103.7592475, 33.255692, 33.254441, 0, 5500], [103.75921477734374, 103.75923113867188, 33.25389483984375, 33.254167919921876, 5500, 6000], [103.7592475, 103.75923113867188, 33.254441, 33.254167919921876, 5500, 6000], [103.756045, 103.7598495, 33.248747, 33.255205000000004, 0, 3500], [103.763654, 103.7598495, 33.261663, 33.255205000000004, 0, 3500], [103.7598495, 103.75975075, 33.255205000000004, 33.254797, 3500, 4000], [103.759652, 103.75975075, 33.254389, 33.254797, 0, 4000], [103.758766, 103.759053, 33.250185, 33.2520285, 0, 3000], [103.75934, 103.759053, 33.253872, 33.2520285, 0, 3000], [103.759053, 103.757595, 33.2520285, 33.250848250000004, 3000, 3500], [103.756137, 103.757595, 33.249668, 33.250848250000004, 0, 3500], [103.758538, 103.7591675, 33.250454, 33.2526055, 0, 2000], [103.759797, 103.7591675, 33.254757, 33.2526055, 0, 2000], [103.7591675, 103.76172775, 33.2526055, 33.25668625, 2000, 2500], [103.764288, 103.76172775, 33.260767, 33.25668625, 0, 2500], [103.76172775, 103.76070737500001, 33.25668625, 33.257743625, 2500, 3000], [103.759687, 103.76070737500001, 33.258801, 33.257743625, 0, 3000], [103.758533, 103.7601205, 33.249152, 33.254596500000005, 0, 2500], [103.761708, 103.7601205, 33.260041, 33.254596500000005, 0, 2500], [103.7601205, 103.76236424999999, 33.254596500000005, 33.25777325, 2500, 3000], [103.764608, 103.76236424999999, 33.26095, 33.25777325, 0, 3000], [103.76070737500001, 103.7615358125, 33.257743625, 33.2577584375, 3000, 3500], [103.76236424999999, 103.7615358125, 33.25777325, 33.2577584375, 3000, 3500], [103.757595, 103.75956540625, 33.250848250000004, 33.25430334375, 3500, 4000], [103.7615358125, 103.75956540625, 33.2577584375, 33.25430334375, 3500, 4000], [103.75975075, 103.759658078125, 33.254797, 33.254550171875, 4000, 4500], [103.75956540625, 103.759658078125, 33.25430334375, 33.254550171875, 4000, 4500], [103.763759, 103.76243249999999, 33.258738, 33.2591985, 0, 4500], [103.761106, 103.76243249999999, 33.259659, 33.2591985, 0, 4500], [103.759658078125, 103.7610452890625, 33.254550171875, 33.256874335937496, 4500, 5000], [103.76243249999999, 103.7610452890625, 33.2591985, 33.256874335937496, 4500, 5000], [103.763755, 103.762867, 33.257167, 33.258626, 0, 2500], [103.761979, 103.762867, 33.260085, 33.258626, 0, 2500], [103.762867, 103.760536, 33.258626, 33.2544385, 2500, 3000], [103.758205, 103.760536, 33.250251, 33.2544385, 0, 3000], [103.760536, 103.762519, 33.2544385, 33.25767225, 3000, 3500], [103.764502, 103.762519, 33.260906, 33.25767225, 0, 3500], [103.759034, 103.7584635, 33.25333, 33.2517495, 0, 3000], [103.757893, 103.7584635, 33.250169, 33.2517495, 0, 3000], [103.755898, 103.7567065, 33.24923, 33.249197499999994, 0, 1000], [103.757515, 103.7567065, 33.249165, 33.249197499999994, 0, 1000], [103.7567065, 103.75794375000001, 33.249197499999994, 33.25118875, 1000, 1500], [103.759181, 103.75794375000001, 33.25318, 33.25118875, 0, 1500], [103.758825, 103.758887, 33.25082, 33.251865499999994, 0, 1500], [103.758949, 103.758887, 33.252911, 33.251865499999994, 0, 1500], [103.75794375000001, 103.758415375, 33.25118875, 33.251527124999996, 1500, 2000], [103.758887, 103.758415375, 33.251865499999994, 33.251527124999996, 1500, 2000], [103.763726, 103.761413, 33.259084, 33.2562715, 0, 500], [103.7591, 103.761413, 33.253459, 33.2562715, 0, 500], [103.761413, 103.76010450000001, 33.2562715, 33.254076749999996, 500, 1000], [103.758796, 103.76010450000001, 33.251882, 33.254076749999996, 0, 1000], [103.76010450000001, 103.75993475000001, 33.254076749999996, 33.254619875, 1000, 1500], [103.759765, 103.75993475000001, 33.255163, 33.254619875, 0, 1500], [103.759423, 103.7574685, 33.25587, 33.2523595, 0, 1500], [103.755514, 103.7574685, 33.248849, 33.2523595, 0, 1500], [103.75993475000001, 103.75870162500001, 33.254619875, 33.2534896875, 1500, 2000], [103.7574685, 103.75870162500001, 33.2523595, 33.2534896875, 1500, 2000], [103.758415375, 103.7585585, 33.251527124999996, 33.25250840625, 2000, 2500], [103.75870162500001, 103.7585585, 33.2534896875, 33.25250840625, 2000, 2500], [103.760635, 103.759985, 33.249185, 33.253396499999994, 0, 2500], [103.759335, 103.759985, 33.257608, 33.253396499999994, 0, 2500], [103.7585585, 103.75927175000001, 33.25250840625, 33.252952453125, 2500, 3000], [103.759985, 103.75927175000001, 33.253396499999994, 33.252952453125, 2500, 3000], [103.7584635, 103.75886762500001, 33.2517495, 33.2523509765625, 3000, 3500], [103.75927175000001, 103.75886762500001, 33.252952453125, 33.2523509765625, 3000, 3500], [103.762519, 103.7606933125, 33.25767225, 33.25501161328125, 3500, 4000], [103.75886762500001, 103.7606933125, 33.2523509765625, 33.25501161328125, 3500, 4000], [103.763725, 103.7637135, 33.256892, 33.258161, 0, 2500], [103.763702, 103.7637135, 33.25943, 33.258161, 0, 2500], [103.7637135, 103.76081575, 33.258161, 33.253977, 2500, 3000], [103.757918, 103.76081575, 33.249793, 33.253977, 0, 3000], [103.75687, 103.7586135, 33.249847, 33.2495125, 0, 2500], [103.760357, 103.7586135, 33.249178, 33.2495125, 0, 2500], [103.7586135, 103.75902024999999, 33.2495125, 33.25391975, 2500, 3000], [103.759427, 103.75902024999999, 33.258327, 33.25391975, 0, 3000], [103.76081575, 103.759918, 33.253977, 33.253948375, 3000, 3500], [103.75902024999999, 103.759918, 33.25391975, 33.253948375, 3000, 3500], [103.758118, 103.758103, 33.24941, 33.2496725, 0, 3500], [103.758088, 103.758103, 33.249935, 33.2496725, 0, 3500], [103.759918, 103.7590105, 33.253948375, 33.2518104375, 3500, 4000], [103.758103, 103.7590105, 33.2496725, 33.2518104375, 3500, 4000], [103.7606933125, 103.75985190624999, 33.25501161328125, 33.25341102539062, 4000, 4500], [103.7590105, 103.75985190624999, 33.2518104375, 33.25341102539062, 4000, 4500], [103.763775, 103.761259, 33.260143, 33.2564345, 0, 2500], [103.758743, 103.761259, 33.252726, 33.2564345, 0, 2500], [103.759195, 103.759321, 33.253657, 33.253660499999995, 0, 2500], [103.759447, 103.759321, 33.253664, 33.253660499999995, 0, 2500], [103.761259, 103.76029, 33.2564345, 33.255047499999996, 2500, 3000], [103.759321, 103.76029, 33.253660499999995, 33.255047499999996, 2500, 3000], [103.76029, 103.75993700000001, 33.255047499999996, 33.25448925, 3000, 3500], [103.759584, 103.75993700000001, 33.253931, 33.25448925, 0, 3500], [103.764301, 103.7640285, 33.262041, 33.260485, 0, 3000], [103.763756, 103.7640285, 33.258929, 33.260485, 0, 3000], [103.7640285, 103.76078924999999, 33.260485, 33.25528, 3000, 3500], [103.75755, 103.76078924999999, 33.250075, 33.25528, 0, 3500], [103.75993700000001, 103.760363125, 33.25448925, 33.254884625, 3500, 4000], [103.76078924999999, 103.760363125, 33.25528, 33.254884625, 3500, 4000], [103.760363125, 103.75955806249999, 33.254884625, 33.2535088125, 4000, 4500], [103.758753, 103.75955806249999, 33.252133, 33.2535088125, 0, 4500], [103.75985190624999, 103.75970498437499, 33.25341102539062, 33.25345991894531, 4500, 5000], [103.75955806249999, 103.75970498437499, 33.2535088125, 33.25345991894531, 4500, 5000], [103.7610452890625, 103.76037513671875, 33.256874335937496, 33.2551671274414, 5000, 5500], [103.75970498437499, 103.76037513671875, 33.25345991894531, 33.2551671274414, 5000, 5500], [103.76037513671875, 103.75764656835938, 33.2551671274414, 33.2516815637207, 5500, 6000], [103.754918, 103.75764656835938, 33.248196, 33.2516815637207, 0, 6000], [103.75923113867188, 103.75843885351563, 33.254167919921876, 33.25292474182129, 6000, 6500], [103.75764656835938, 103.75843885351563, 33.2516815637207, 33.25292474182129, 6000, 6500]]
%figure
hold on
for i = 1:6:852
    p = plot3([tree(i),tree(i+1)],[tree(i+2),tree(i+3)],[tree(i+4)/8+2630,tree(i+5)/8+2630],'Color', '#D9842F', 'LineWidth', 0.5);
    % add the point
    point = plot3(tree(i+1), tree(i+3), tree(i+5)/8+2630, 'wo', 'MarkerSize', 2, 'MarkerFaceColor', 'black');
    hold on
end
tree = [[103.759651, 103.7594995, 33.254038, 33.255901, 0, 3000], [103.759348, 103.7594995, 33.257764, 33.255901, 0, 3000], [103.756904, 103.7584095, 33.248951, 33.253951, 0, 3000], [103.759915, 103.7584095, 33.258951, 33.253951, 0, 3000], [103.7594995, 103.7589545, 33.255901, 33.254926, 3000, 3500], [103.7584095, 103.7589545, 33.253951, 33.254926, 3000, 3500], [103.759689, 103.762289, 33.254553, 33.259387000000004, 0, 3500], [103.764889, 103.762289, 33.264221, 33.259387000000004, 0, 3500], [103.7589545, 103.76062175, 33.254926, 33.2571565, 3500, 4000], [103.762289, 103.76062175, 33.259387000000004, 33.2571565, 3500, 4000], [103.76062175, 103.760049375, 33.2571565, 33.255658249999996, 4000, 4500], [103.759477, 103.760049375, 33.25416, 33.255658249999996, 0, 4500]]
for i = 1:6:72
    p = plot3([tree(i),tree(i+1)],[tree(i+2),tree(i+3)],[tree(i+4)/8+2630,tree(i+5)/8+2630],'Color', '#3820E8', 'LineWidth', 0.5);
    % add the point
    point = plot3(tree(i+1), tree(i+3), tree(i+5)/8+2630, 'ro', 'MarkerSize', 2, 'MarkerFaceColor', 'black');
    hold on
end


for i = 1:6:420
    p = plot3([tree2(i),tree2(i+1)],[tree2(i+2),tree2(i+3)],[tree2(i+4)/10+2630,tree2(i+5)/10+2630],'Color', [0, 0, 0, 0.5], 'LineWidth', 0.5)
    hold on
end
for i = 1:6:1284
    p = plot3([103.766,103.766],[tree(i+2),tree(i+3)],[tree(i+4)+2630,tree(i+5)+2630],'Color', [0, 0, 0, 0.5], 'LineWidth', 2);
    hold on
end

for i = 1:6:1284
    p = plot3([tree(i),tree(i+1)],[33.265,33.265],[tree(i+4)+2030,tree(i+5)+2030],'Color', [0, 0, 0, 0.5], 'LineWidth', 2);
    hold on
end

for i = 1:6:1284
    p = plot3([tree(i),tree(i+1)],[tree(i+2),tree(i+3)],[4500,4500],'Color', [0, 0, 0, 0.5], 'LineWidth', 2);
    hold on
end

set(gca,'ZTick',[]);
set(gca, 'ZColor', 'none');
plot3([103.7658,103.7658],[33.2645,33.2645],[2620,5000])
plot3([103.7658,103.7658],[33.2645,33.2645],[2620,5000],'k')

plot3([103.7658,103.7658],[33.2645,33.2645],[2500,3300],'k')
plot3([103.7545,103.7545],[33.2645,33.2645],[2500,3300],'k')
plot3([103.7545,103.7545],[33.2475,33.2475],[2500,3300],'k')
IdleTimeout has been reached.
Parallel pool using the 'Processes' profile is shutting down.

plot3([103.7545,103.7545],[33.2645,33.2645],[2200,3300],'k')
plot3([103.7545,103.7658],[33.2645,33.2645],[3300,3300],'k')
plot3([103.7545,103.7658],[33.2645,33.2645],[2200,2200],'k')
plot3([103.7545,103.7545],[33.2475,33.2645],[2200,2200],'k')
plot3([103.7545,103.7545],[33.2475,33.2645],[3300,3300],'k')
xlim([2500,5000])
xlim([103.7545,103.7658]);
zlim([2500,5000])
plot3([103.7545,103.7545],[33.2475,33.2645],[2500,2500],'k')
plot3([103.7545,103.7658],[33.2645,33.2645],[2500,2500],'k')

plot3([103.755,103.755],[33.2475,33.2645],[2500,2500],'k')
plot3([103.760,103.760],[33.2475,33.2645],[2500,2500],'k')
plot3([103.765,103.765],[33.2475,33.2645],[2500,2500],'k')

plot3([103.7545,103.7658],[33.250,33.250],[2500,2500],'k')
plot3([103.7545,103.7658],[33.255,33.255],[2500,2500],'k')
plot3([103.7545,103.7658],[33.260,33.260],[2500,2500],'k')





tiff2 = imread('path\jzg3_Clip3_2.tif');

% as the file is too large, we need make it smaller

Red2 = tiff2(:,:,1);
Green2 = tiff2(:,:,2);
Blue2 = tiff2(:,:,3);
alpha2 = tiff2(:,:,4);

% plot the tiff file 
tif_rgb2 = cat(3, Red2, Green2, Blue2);
imshow(tif_rgb2);
title('tiff file');

DEM2= imread('path\jzg_DEM_Clip1_1.tif');
DEM2 = flipud(DEM2);
[rows2, cols2,~] = size(tif_rgb2)
DEM2 = DEM2(1:rows2, 1:cols2);

info2 = geotiffinfo('path\jzg3_Clip3_2.tif');
[xlim2,ylim2] = deal(info2.BoundingBox(1:2,1),info2.BoundingBox(1:2,2));
[X2,Y2] = meshgrid(linspace(xlim2(1),xlim2(2),cols2),linspace(ylim2(1),ylim2(2),rows2));
S = shaperead('path\typha_jzg22.shp');

figure 
h2 = surf(X2,Y2,double(DEM2),'EdgeColor','none');

% apply the RGB image as a texture map
set(h2,'CData',flipud(tif_rgb2),'FaceColor','texturemap');

% set the alpha data for transparencey
set(h2, 'AlphaData', flipud(alpha2), 'FaceAlpha', 'texturemap');
tiff3 = imread('path\jzg3_Clip3_3.tif');

% as the file is too large, we need make it smaller

Red3 = tiff3(:,:,1);
Green3 = tiff3(:,:,2);
Blue3 = tiff3(:,:,3);
alpha3 = tiff3(:,:,4);

% plot the tiff file 
tif_rgb3 = cat(3, Red3, Green3, Blue3);
% imshow(tif_rgb3);
title('tiff file');

DEM3= imread('path\jzg_DEM_Clip1_2.tif');
DEM3 = flipud(DEM3);
[rows3, cols3,~] = size(tif_rgb3)
DEM3 = DEM3(1:rows3, 1:cols3);

info3 = geotiffinfo('path\jzg3_Clip3_3.tif');
[xlim3,ylim3] = deal(info3.BoundingBox(1:2,1),info3.BoundingBox(1:2,2));
[X3,Y3] = meshgrid(linspace(xlim3(1),xlim3(2),cols3),linspace(ylim3(1),ylim3(2),rows3));
% S = shaperead('path\T_lat\typha_jzg22.shp');

figure 
h3 = surf(X3,Y3,double(DEM3),'EdgeColor','none');

% apply the RGB image as a texture map
set(h3,'CData',flipud(tif_rgb3),'FaceColor','texturemap');

% set the alpha data for transparencey
set(h3, 'AlphaData', flipud(alpha3), 'FaceAlpha', 'texturemap');

